reg   = 0.03,
reg_m = 0.02
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.02
)
adata   <-  res[[0]]
metrics <-  res[[1]]
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
# K_ref = 512,
#  K_batch = 256,
#  reg   = 0.03,
#  reg_m = 0.02
)
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
# K_ref = 512,
#  K_batch = 256,
#  reg   = 0.03,
#  reg_m = 0.02
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.02
)
adata   <-  res[[0]]
metrics <-  res[[1]]
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.02
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.0
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='atac', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
reference='largest',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.0
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
reference='largest',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.0
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
reference='largest',
K_ref = 512,
K_batch = 256,
reg   = 0.03,
reg_m = 0.0
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
alldata <- NormalizeData(alldata,
normalization.method = "LogNormalize",
scale.factor = 10000) %>%
FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
ScaleData(features = VariableFeatures(object = alldata),
vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
RunPCA(npcs = 30)
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
adata <- sceasy::convertFormat(alldata, from="seurat", to="anndata", main_layer="counts", drop_single_values=FALSE)
print(adata)
sceasy::convertFormat(
alldata,
from = "seurat",
to = "anndata",
main_layer = "counts",
drop_single_values = FALSE,
outFile = "ifnb.h5ad"   # <- this makes the .h5ad file
)
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
alldata <- NormalizeData(alldata,
normalization.method = "LogNormalize",
scale.factor = 10000) %>%
FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
ScaleData(features = VariableFeatures(object = alldata),
vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
RunPCA(npcs = 30)
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
# alldata <- NormalizeData(alldata,
#                          normalization.method = "LogNormalize",
#                          scale.factor = 10000) %>%
#             FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
#             ScaleData(features = VariableFeatures(object = alldata),
#                       vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
#             RunPCA(npcs = 30)
library(reticulate)
# devtools::install_github("cellgeni/sceasy")
library(sceasy)
sc <- import("scanpy", convert = FALSE)
scb <- import("scbiot", convert = FALSE)
adata <- sceasy::convertFormat(alldata, from="seurat", to="anndata", main_layer="counts", drop_single_values=FALSE)
print(adata)
sceasy::convertFormat(
alldata,
from = "seurat",
to = "anndata",
main_layer = "counts",
drop_single_values = FALSE,
outFile = "ifnb.h5ad"   # <- this makes the .h5ad file
)
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
)
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
# alldata <- NormalizeData(alldata,
#                          normalization.method = "LogNormalize",
#                          scale.factor = 10000) %>%
#             FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
#             ScaleData(features = VariableFeatures(object = alldata),
#                       vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
#             RunPCA(npcs = 30)
library(reticulate)
# devtools::install_github("cellgeni/sceasy")
library(sceasy)
sc <- import("scanpy", convert = FALSE)
scb <- import("scbiot", convert = FALSE)
adata <- sceasy::convertFormat(alldata, from="seurat", to="anndata", main_layer="counts", drop_single_values=FALSE)
print(adata)
sceasy::convertFormat(
alldata,
from = "seurat",
to = "anndata",
main_layer = "counts",
drop_single_values = FALSE,
outFile = "ifnb.h5ad"   # <- this makes the .h5ad file
)
sc$pp$highly_variable_genes(
adata,
n_top_genes = as.integer(2000),
flavor = "seurat_v3",
batch_key = "stim"
)
sc$pp$normalize_total(adata)
sc$pp$log1p(adata)
sc$pp$scale(adata)
sc$tl$pca(adata, n_comps = as.integer(50), use_highly_variable = TRUE)
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
# run setup_anndata
scb$pp$setup_anndata(adata, var_key='X_ot', batch_key='stim', pseudo_key='leiden_X_ot', true_key=NULL, overwrite=TRUE)
model <- scb$models$vae(adata, verbose=TRUE)
model$train()
# get the latent represenation
latent <- model$get_latent_representation(n_compoents=as.integer(30),
svd_solver='arpack',
random_state=as.integer(42))
# put it back in our original Seurat object
latent <- as.matrix(latent)
rownames(latent) = colnames(alldata)
alldata[["scbiot"]] <- CreateDimReducObject(embeddings = latent, key = "scbiot_", assay = DefaultAssay(alldata))
alldata <- RunUMAP(alldata, dims = 1:30, reduction = "scbiot")
alldata <- FindNeighbors(alldata, dims = 1:30,
reduction = "scbiot",
k.param = 15)
alldata <- FindClusters(
alldata,
resolution = 0.8,
cluster.name =  "scbiot.res.0.8")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
info <- sessionInfo()
info$loadedOnly <- NULL
print(info, locale=FALSE)
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
alldata <- NormalizeData(alldata,
normalization.method = "LogNormalize",
scale.factor = 10000) %>%
FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
ScaleData(features = VariableFeatures(object = alldata),
vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
RunPCA(npcs = 30)
library(reticulate)
# devtools::install_github("cellgeni/sceasy")
library(sceasy)
sc <- import("scanpy", convert = FALSE)
scb <- import("scbiot", convert = FALSE)
adata <- sceasy::convertFormat(alldata, from="seurat", to="anndata", main_layer="counts", drop_single_values=FALSE)
print(adata)
sceasy::convertFormat(
alldata,
from = "seurat",
to = "anndata",
main_layer = "counts",
drop_single_values = FALSE,
outFile = "ifnb.h5ad"   # <- this makes the .h5ad file
)
# sc$pp$highly_variable_genes(
#   adata,
#   n_top_genes = as.integer(2000),
#   flavor = "seurat_v3",
#   batch_key = "stim"
# )
# sc$pp$normalize_total(adata)
# sc$pp$log1p(adata)
# sc$pp$scale(adata)
# sc$tl$pca(adata, n_comps = as.integer(50), use_highly_variable = TRUE)
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
# run setup_anndata
scb$pp$setup_anndata(adata, var_key='X_ot', batch_key='stim', pseudo_key='leiden_X_ot', true_key=NULL, overwrite=TRUE)
model <- scb$models$vae(adata, verbose=TRUE)
model$train()
# get the latent represenation
latent <- model$get_latent_representation(n_compoents=as.integer(30),
svd_solver='arpack',
random_state=as.integer(42))
# put it back in our original Seurat object
latent <- as.matrix(latent)
rownames(latent) = colnames(alldata)
alldata[["scbiot"]] <- CreateDimReducObject(embeddings = latent, key = "scbiot_", assay = DefaultAssay(alldata))
alldata <- RunUMAP(alldata, dims = 1:30, reduction = "scbiot")
alldata <- FindNeighbors(alldata, dims = 1:30,
reduction = "scbiot",
k.param = 15)
alldata <- FindClusters(
alldata,
resolution = 0.8,
cluster.name =  "scbiot.res.0.8")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
info <- sessionInfo()
info$loadedOnly <- NULL
print(info, locale=FALSE)
# rm(list=ls())
library(Seurat)
library(reticulate)
# devtools::install_github("satijalab/seurat-data")
# SeuratData::InstallData("ifnb")
library(SeuratData)
library(tidyverse)
data("ifnb")
alldata <- UpdateSeuratObject(ifnb)
alldata[["pct_mt"]] <- PercentageFeatureSet(alldata, pattern = "^MT-")
alldata <- subset(alldata, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & pct_mt < 5)
# alldata <- NormalizeData(alldata,
#                          normalization.method = "LogNormalize",
#                          scale.factor = 10000) %>%
#             FindVariableFeatures(selection.method = 'vst', nfeatures = 2000) %>%
#             ScaleData(features = VariableFeatures(object = alldata),
#                       vars.to.regress = c("nCount_RNA", "pct_mt")) %>%
#             RunPCA(npcs = 30)
library(reticulate)
# devtools::install_github("cellgeni/sceasy")
library(sceasy)
sc <- import("scanpy", convert = FALSE)
scb <- import("scbiot", convert = FALSE)
adata <- sceasy::convertFormat(alldata, from="seurat", to="anndata", main_layer="counts", drop_single_values=FALSE)
print(adata)
sceasy::convertFormat(
alldata,
from = "seurat",
to = "anndata",
main_layer = "counts",
drop_single_values = FALSE,
outFile = "ifnb.h5ad"   # <- this makes the .h5ad file
)
sc$pp$highly_variable_genes(
adata,
n_top_genes = as.integer(2000),
flavor = "seurat_v3",
batch_key = "stim"
)
sc$pp$normalize_total(adata)
sc$pp$log1p(adata)
sc$pp$scale(adata)
sc$tl$pca(adata, n_comps = as.integer(50), use_highly_variable = TRUE)
res <-  scb$ot$integrate(adata, modality='rna', obsm_key='X_pca', batch_key='stim', out_key='X_ot',
ot_mode='balanced',
)
adata   <-  res[[0]]
metrics <-  res[[1]]
sc$pp$neighbors(adata, use_rep='X_ot')
sc$tl$umap(adata)
sc$tl$leiden(adata, resolution=0.8, key_added='leiden_X_ot')
adata
ot <- as.matrix(adata$obsm['X_umap'])
rownames(ot) = colnames(alldata)
alldata[["ot"]] <- CreateDimReducObject(embeddings = ot, key = "ot_umap_", assay = DefaultAssay(alldata))
DimPlot(alldata, reduction = "ot", group.by = "stim", label = TRUE) + ggtitle("Optimal Transport Integration")
# run setup_anndata
scb$pp$setup_anndata(adata, var_key='X_ot', batch_key='stim', pseudo_key='leiden_X_ot', true_key=NULL, overwrite=TRUE)
model <- scb$models$vae(adata, verbose=TRUE)
model$train()
# get the latent represenation
latent <- model$get_latent_representation(n_compoents=as.integer(30),
svd_solver='arpack',
random_state=as.integer(42))
# put it back in our original Seurat object
latent <- as.matrix(latent)
rownames(latent) = colnames(alldata)
alldata[["scbiot"]] <- CreateDimReducObject(embeddings = latent, key = "scbiot_", assay = DefaultAssay(alldata))
alldata <- RunUMAP(alldata, dims = 1:30, reduction = "scbiot")
alldata <- FindNeighbors(alldata, dims = 1:30,
reduction = "scbiot",
k.param = 15)
alldata <- FindClusters(
alldata,
resolution = 0.8,
cluster.name =  "scbiot.res.0.8")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
alldata <- NormalizeData(alldata,
normalization.method = "LogNormalize",
scale.factor = 10000) %>%
ScaleData(features = VariableFeatures(object = alldata),
vars.to.regress = c("nCount_RNA", "pct_mt"))
FeaturePlot(alldata, features = c("SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
"CCL2", "PPBP"), min.cutoff = "q9", pt.size = 0.2, ncol = 4)
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
info <- sessionInfo()
info$loadedOnly <- NULL
print(info, locale=FALSE)
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
DimPlot(alldata, reduction = "umap", group.by = "stim", label = TRUE) + ggtitle("scBIOT Integration")
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
cols = c("grey", "darkred"))
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3, pt.size = 0.2,
cols = c("grey", "darkred"))
FeaturePlot(alldata, features = c("GNLY", "IFI6"), split.by = "stim", max.cutoff = 3, pt.size = 0.1,
cols = c("grey", "darkred"))
